{% extends "base_store_manage.html" %}

{% block title %}Imly | Create Shop{% endblock title %}
{% block manage_store_navigation %}

    <li class="active"><a href="{% url "imly_store_info" %}">Shop Details</a></li>
    <li class="disabled"><a href="#">Product Details</a></li>

    <li class="disabled"><a href="#">Order Details</a></li>
    {% if request.user.userprofile %}
        <li><a href="{% url "imly_my_profile" %}">My Profile</a></li>
    {% else %}
        <li><a href="{% url "imly_create_profile" %}">My Profile</a></li>
    {% endif %}

    
                
{% endblock manage_store_navigation %}

{% block shop_content %}
    <h4 class="form_heading">Create Your Shop</h4>
    <br>
        {% load crispy_forms_tags %}
        <form enctype="multipart/form-data" method="post" action="">
            {% crispy form %}
        <div style="display:none;" id="delivery_location_form" class="delivery_location_form">
        <fieldset class="formset" id="delivery_location_formset">
            
            {{ delivery_location_form.management_form }}
			<div class="delivery_locations">
            {% for form in delivery_location_form %}
				<div class="delivery_location">
			    {{form}}
				</div>
            {% endfor %}
			</div>

        </fieldset>
		<input type="text" name="location_autocompleter" id="delivery_locator"></br>
    </div>
		<script type="text/html" id="delivery_location_template">
			<div class="delivery_location">
				<label for="id_delivery_locations-<%= id %>-name">Name:</label>
				<input id="id_delivery_locations-<%= id %>-name" type="text" name="delivery_locations-<%= id %>-name" maxlength="100" value="<%= name %>">
				<label for="id_delivery_locations-<%= id %>-DELETE">Delete:</label>
				<input id="id_delivery_locations-<%= id %>-DELETE" type="checkbox" name="delivery_locations-<%= id %>-DELETE">
				
				<input id="id_delivery_locations-<%= id %>-id" type="hidden" name="delivery_locations-<%= id %>-id">
				<input id="id_delivery_locations-<%= id %>-store" type="hidden" name="delivery_locations-<%= id %>-store">
			</div>
		</script>
        <a href="{% url "imly_store_info" %}" class="btn">Cancel</a>
         <input type="submit" class="btn btn-success" value="Submit for Approval">
        </form>
{% endblock shop_content %}
                

{% block shop_info %}
    <aside class="well shop_info">
        <h4 class="text-center orange">Tips</h4>

        <div class="row-fluid">
            <div class="span10 offset1">
                <hr>
            </div>
        </div>
                
        <ol class="tips">
            <li>Choose a <span class="orange">memorable name</span> for your store.</li>
            <li>A tagline can help to reinforce your brand. A catchy phrase is hard to forget.</li>
            <li>Keep the description short but <span class="orange">interesting</span>. Customers only skim through. Make sure they see what is most important.</li>
        </ol>
    </aside>                     
{% endblock shop_info %} 
{% block extra_javascript %}
<script>
	var default_bounds = new google.maps.LatLngBounds(
		new google.maps.LatLng(19.26, 72.98),
		new google.maps.LatLng(18.89, 72.775)); 
	var google_map_api_options = {
		bounds: default_bounds,
		componentRestrictions: {country: 'in'}
	};
	var autocomplete_delivery = new google.maps.places.Autocomplete(document.getElementById('delivery_locator'), google_map_api_options);

	google.maps.event.addListener(autocomplete_delivery, 'place_changed', function(){
		var count = $('.delivery_locations').children().length;
		var markup = $('#delivery_location_template').html()
		var compiled = _.template(markup, {id: count, name: $('#delivery_locator').val()});
		$('div.delivery_locations').append(compiled);
		$('#id_delivery_locations-TOTAL_FORMS').attr('value', count + 1);
	});
</script>
{% endblock extra_javascript %}